function listSheetNamesInFolder() {
  // Replace 'FOLDER_NAME' with the name of the folder you want to scan
  var folderName = 'FOLDER_NAME';

  // Replace 'DESTINATION_SHEET_URL' with the URL of the sheet where you want to paste the information
  var destinationSheetUrl = 'DESTINATION_SHEET_URL';

  // Replace 'DESTINATION_TAB_NAME' with the name of the tab where you want to paste the information
  var destinationTabName = 'DESTINATION_TAB_NAME';

  // Get the destination sheet by URL
  var destinationSpreadsheet = SpreadsheetApp.openByUrl(destinationSheetUrl);
  var destinationSheet = destinationSpreadsheet.getSheetByName(destinationTabName);

  // Clear existing data in the destination sheet
  destinationSheet.clear();

  // Set the headers in the destination sheet
  destinationSheet.getRange(1, 1).setValue('Spreadsheet Name');
  destinationSheet.getRange(1, 2).setValue('Sheet Name');

  try {
    // Get all files in the root of Google Drive using DriveApp service
    var folder = DriveApp.getFoldersByName(folderName).next();
    var files = folder.getFiles();

    // Loop through each file
    while (files.hasNext()) {
      var file = files.next();
      var spreadsheet = SpreadsheetApp.openById(file.getId());

      // Get all sheet names in the current spreadsheet
      var sheetNames = spreadsheet.getSheets().map(function(sheet) {
        return sheet.getName();
      });

      // Get the first row without data in the destination sheet
      var nextRow = destinationSheet.getLastRow() + 1;

      // Log information for troubleshooting
      Logger.log('Processing file: %s', file.getName());
      Logger.log('Sheet names: %s', sheetNames.join(', '));

      // Paste spreadsheet name into the destination sheet
      destinationSheet.getRange(nextRow, 1).setValue(file.getName());

      // Paste sheet names into the destination sheet
      destinationSheet.getRange(nextRow, 2, sheetNames.length, 1).setValues(sheetNames.map(function(name) {
        return [name];
      }));

      Logger.log('Data successfully written to the destination sheet.');
    }
  } catch (error) {
    Logger.log('Error: ' + error.toString());
  }
}
