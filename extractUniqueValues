/**
 * Custom function to extract unique values from a range of cells.
 *
 * @param {string[][]} rangeValues - The values from the range to process.
 * @return {string[][]} - The unique values in a 2D array.
 * @customfunction
 */
function EXTRACT_UNIQUE_VALUES(rangeValues) {
  try {
    if (!rangeValues || rangeValues.length === 0) {
      throw new Error("Invalid parameter");
    }

    var uniqueValues = [];

    // Iterate through each row in the range
    for (var i = 0; i < rangeValues.length; i++) {
      if (rangeValues[i][0]) {
        var values = rangeValues[i][0].split("-");
        values = values.map(function (val) {
          return val.trim().toLowerCase();
        });

        // Combine unique values
        for (var j = 0; j < values.length; j++) {
          if (uniqueValues.indexOf(values[j]) === -1) {
            uniqueValues.push([values[j]]);
          }
        }
      }
    }

    return uniqueValues;
  } catch (error) {
    return [["Error: " + error.message]];
  }
}
