/**
 * Custom function to extract unique subparts between hyphens from a range of cells.
 *
 * @param {string[][]} rangeValues - The values from the range to process.
 * @return {string[][]} - The unique subparts in a 2D array.
 * @customfunction
 */
function EXTRACT_UNIQUE_SUBPARTS(rangeValues) {
  try {
    if (!rangeValues || rangeValues.length === 0) {
      throw new Error("Invalid parameter");
    }

    var uniqueSubparts = {};

    // Iterate through each row in the range
    for (var i = 0; i < rangeValues.length; i++) {
      if (rangeValues[i][0]) {
        var values = rangeValues[i][0].split("-");
        values = values.map(function (val) {
          return val.trim().toLowerCase();
        });

        // Combine unique subparts
        for (var j = 0; j < values.length; j++) {
          uniqueSubparts[values[j]] = true;
        }
      }
    }

    // Convert unique subparts to a 2D array
    var resultArray = Object.keys(uniqueSubparts).map(function (val) {
      return [val];
    });

    return resultArray;
  } catch (error) {
    return [["Error: " + error.message]];
  }
}
